A **deep link** is a URI that allows an application to navigate directly to a specific internal screen, feature, or functionality, rather than opening the app's main or default activity.

```xml
myapp://user/profile?id=123
allsafe://infosecadventures/congrats/?key=xxxx
```

Apps define deep links in the `AndroidManifest.xml` via **intent-filters**:
```xml
<activity android:name=".DeepLinkTask" android:exported="true">
    <intent-filter>
        <action android:name="android.intent.action.VIEW"/>
        <category android:name="android.intent.category.DEFAULT"/>
        <category android:name="android.intent.category.BROWSABLE"/>
        <data android:scheme="allsafe" android:host="infosecadventures" android:path="/congrats/"/>
    </intent-filter>
</activity>
```


---

## How Deep Links Are Normally Triggered

1. **Externally:**
    - Via browser, email, QR code, or other apps.
    - Android resolves the URI to the correct activity using the **intent-filter**.
    - App validates parameters (e.g., `key`) and executes the internal logic.
2. **Internally:**
    - App constructs the same Intent programmatically:
```bash
val intent = Intent(Intent.ACTION_VIEW)
intent.data = Uri.parse("allsafe://infosecadventures/congrats/?key=xxx")
startActivity(intent)
```


---

## Launching a Deep Link via ADB

**Syntax:**
```bash
adb shell am start -W -a android.intent.action.VIEW -d "<DEEP_LINK_URL>" [-n <PACKAGE>/<ACTIVITY>]
```

- `-d "<URL>"` = the deep link URI
- `-a android.intent.action.VIEW` = action to open a URI
- `-n <PACKAGE>/<ACTIVITY>` = optional, forces a specific activity

**Example:**
```bash
adb shell am start -W -a android.intent.action.VIEW \
-d "allsafe://infosecadventures/congrats/?key=ebfb7ff0-b2f6-41c8-bef3-4fba17be410c"
```

---

## Security Risks of Triggering a Deep Link Externally

- **Bypass of normal navigation and access controls:**
    - External execution allows reaching internal screens or features without following the intended user interface flow.
    - This could let attackers access areas normally restricted to certain users or roles.
    
- **Execution of sensitive internal logic:**
    - Flows triggered by deep links may perform actions such as unlocking features, applying rewards, or updating data.
    - If parameter validation is weak, an attacker could manipulate inputs to achieve unauthorized effects.
    
- **Parameter tampering vulnerabilities:**
    - Keys, IDs, or tokens passed via the deep link may be accepted without proper verification.
    - This could allow bypassing authentication, privilege escalation, or unlocking hidden functionalities.
    
- **Increased attack surface:**
    - Any exported activity that handles deep links becomes an entry point for exploitation.
    - Poorly secured deep links could be abused to perform replay attacks, unauthorized operations, or privilege escalations.